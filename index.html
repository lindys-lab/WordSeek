    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Seek</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            max-width: 400px;
            margin: 0 auto;
        }
        #word-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="container bg-gray-800 p-8 rounded-xl shadow-2xl">
        <h1 class="text-4xl font-extrabold text-center mb-6">Word Seek</h1>
        <div id="game-status" class="text-center mb-4 text-purple-400 font-medium">Click "New Game" to begin!</div>

        <div class="grid-container" id="grid-container" aria-label="Game grid">
            <!-- grid cells will be inserted here -->
        </div>

        <div id="current-word-display" class="text-center mt-6 text-3xl font-extrabold text-white h-10"></div>

        <div class="flex justify-center mt-6 space-x-4">
            <button id="submit-btn" class="p-3 rounded-lg font-bold transition-transform transform hover:scale-105 shadow-md bg-purple-600 text-white" disabled>Submit Word</button>
            <button id="clear-btn" class="p-3 rounded-lg font-bold transition-transform transform hover:scale-105 shadow-md bg-gray-600 text-white" disabled>Clear</button>
            <button id="new-game-btn" class="p-3 rounded-lg font-bold transition-transform transform hover:scale-105 shadow-md bg-green-600 text-white">New Game</button>
        </div>

        <div id="word-list-container" class="hidden mt-6 max-h-48 overflow-y-auto bg-gray-900 p-4 rounded-lg">
            <h3 class="text-xl font-semibold mb-2 text-center">Found Words (<span id="found-count">0</span>)</h3>
            <ul id="found-words" class="list-none p-0 m-0 text-center">
                <!-- found words will be inserted here -->
            </ul>
        </div>
    </div>

    <script>
        // Game State Variables
        const gridSize = 3;
        let gameGrid = [];
        let dictionary = new Set();
        let currentWord = '';
        let selectedCells = new Set();
        let foundWords = new Set();
        let availableWords = new Set();
        let isGameReady = false;

        // DOM Elements
        const gridContainer = document.getElementById('grid-container');
        const currentWordDisplay = document.getElementById('current-word-display');
        const submitBtn = document.getElementById('submit-btn');
        const clearBtn = document.getElementById('clear-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const gameStatus = document.getElementById('game-status');
        const foundWordsList = document.getElementById('found-words');
        const foundCountDisplay = document.getElementById('found-count');
        const wordListContainer = document.getElementById('word-list-container');
        
        // --- Core Game Functions ---

        async function loadAndPrepareGame() {
            gameStatus.textContent = "Loading word list...";
            try {
                // Correctly fetch and parse the plain text word list
                const response = await fetch('wordlist.txt');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const text = await response.text();
                // Split the text into an array, filter out empty lines, and convert to a Set
                dictionary = new Set(text.split(/\s+/).filter(word => word.length > 0));

                gameStatus.textContent = "Word list loaded successfully!";
                isGameReady = true;
                newGameBtn.disabled = false;
            } catch (error) {
                gameStatus.textContent = `Error: Could not load word list. Please ensure wordlist.txt is in the same folder.`;
                console.error("Error loading dictionary:", error);
            }
        }

        function generateGrid() {
            gridContainer.innerHTML = '';
            gameGrid = [];
            currentWord = '';
            selectedCells.clear();
            currentWordDisplay.textContent = '';
            updateButtonState();

            const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            const newGrid = Array.from({ length: gridSize }, () => Array(gridSize).fill(''));

            for (let row = 0; row < gridSize; row++) {
                for (let col = 0; col < gridSize; col++) {
                    const letter = letters.charAt(Math.floor(Math.random() * letters.length));
                    newGrid[row][col] = letter;
                    
                    const cell = document.createElement('div');
                    cell.textContent = letter;
                    cell.className = 'h-20 w-20 flex items-center justify-center text-3xl font-bold bg-gray-800 rounded-lg cursor-pointer transition-all duration-200 ease-in-out focus:outline-none';
                    cell.setAttribute('data-row', row);
                    cell.setAttribute('data-col', col);
                    cell.setAttribute('tabindex', '-1');
                    gridContainer.appendChild(cell);
                }
            }
            gameGrid = newGrid;
            findAvailableWords();
            gameStatus.textContent = "New game started! Find as many words as you can.";
        }

        function findAvailableWords() {
            availableWords.clear();
            const visited = Array.from({ length: gridSize }, () => Array(gridSize).fill(false));
            const wordsFound = new Set();

            function search(row, col, currentPath, currentString) {
                const cellKey = `${row}-${col}`;
                if (currentPath.has(cellKey)) return;
                
                const newString = currentString + gameGrid[row][col];
                const newPath = new Set(currentPath).add(cellKey);
                
                if (dictionary.has(newString) && !foundWords.has(newString)) {
                    wordsFound.add(newString);
                }
                
                // Explore neighbors (8 directions)
                for (let dRow = -1; dRow <= 1; dRow++) {
                    for (let dCol = -1; dCol <= 1; dCol++) {
                        if (dRow === 0 && dCol === 0) continue;
                        
                        const nextRow = row + dRow;
                        const nextCol = col + dCol;
                        
                        if (nextRow >= 0 && nextRow < gridSize && nextCol >= 0 && nextCol < gridSize) {
                            search(nextRow, nextCol, newPath, newString);
                        }
                    }
                }
            }

            for (let row = 0; row < gridSize; row++) {
                for (let col = 0; col < gridSize; col++) {
                    search(row, col, new Set(), "");
                }
            }
            availableWords = wordsFound;
            console.log("Available words:", availableWords); // For debugging purposes
        }

        function newGame() {
            if (!isGameReady) {
                gameStatus.textContent = "Game not ready. Please wait for the word list to load.";
                return;
            }
            foundWords.clear();
            updateFoundWordsList();
            wordListContainer.classList.add('hidden');
            generateGrid();
        }

        function selectLetter(cell) {
            const row = parseInt(cell.getAttribute('data-row'));
            const col = parseInt(cell.getAttribute('data-col'));
            const cellKey = `${row}-${col}`;

            if (selectedCells.has(cellKey)) {
                // Deselect if already selected
                selectedCells.delete(cellKey);
                cell.classList.remove('ring-4', 'ring-purple-500', 'bg-purple-600', 'selected');
                updateCurrentWord();
            } else {
                // Check if the cell is adjacent to the last selected cell
                let isAdjacent = true;
                if (selectedCells.size > 0) {
                    const lastSelected = Array.from(selectedCells).pop();
                    const [lastRow, lastCol] = lastSelected.split('-').map(Number);
                    if (Math.abs(lastRow - row) > 1 || Math.abs(lastCol - col) > 1) {
                        isAdjacent = false;
                    }
                }

                if (isAdjacent) {
                    selectedCells.add(cellKey);
                    cell.classList.add('ring-4', 'ring-purple-500', 'bg-purple-600', 'selected');
                    updateCurrentWord();
                } else {
                    alert("You can only select adjacent letters!");
                }
            }
        }

        function updateCurrentWord() {
            const sortedCells = Array.from(selectedCells).sort();
            let newWord = '';
            sortedCells.forEach(cellKey => {
                const [row, col] = cellKey.split('-').map(Number);
                newWord += gameGrid[row][col];
            });
            currentWord = newWord;
            currentWordDisplay.textContent = newWord;
            updateButtonState();
        }

        function submitWord() {
            if (dictionary.has(currentWord.toUpperCase())) {
                if (foundWords.has(currentWord.toUpperCase())) {
                    gameStatus.textContent = `You already found "${currentWord.toUpperCase()}"!`;
                } else {
                    foundWords.add(currentWord.toUpperCase());
                    updateFoundWordsList();
                    gameStatus.textContent = `Correct! You found "${currentWord.toUpperCase()}"!`;
                    // Highlight the correct word on the grid
                    highlightCells('correct');
                    // Remove word from available words list
                    availableWords.delete(currentWord.toUpperCase());
                }
            } else {
                gameStatus.textContent = `Incorrect word: "${currentWord.toUpperCase()}"`;
                highlightCells('incorrect');
            }
            setTimeout(() => {
                clearAndReset();
            }, 1000);
        }

        function highlightCells(className) {
            gridContainer.querySelectorAll('.grid-cell, .h-20').forEach(cell => {
                const row = parseInt(cell.getAttribute('data-row'));
                const col = parseInt(cell.getAttribute('data-col'));
                const cellKey = `${row}-${col}`;
                if (selectedCells.has(cellKey)) {
                    if (className === 'correct') {
                        cell.classList.add('bg-green-600');
                        cell.classList.remove('bg-red-600');
                    } else if (className === 'incorrect') {
                        cell.classList.add('bg-red-600');
                        cell.classList.remove('bg-green-600');
                    }
                }
            });
        }
        
        function clearAndReset(message = "Word cleared.") {
            selectedCells.clear();
            currentWord = '';
            currentWordDisplay.textContent = '';
            gridContainer.querySelectorAll('.grid-cell, .h-20').forEach(cell => {
                cell.classList.remove('ring-4', 'ring-purple-500', 'bg-purple-600', 'selected', 'bg-green-600', 'bg-red-600');
            });
            updateButtonState();
            gameStatus.textContent = message;
        }

        function updateButtonState() {
            const hasSelection = selectedCells.size > 0;
            submitBtn.disabled = !hasSelection;
            clearBtn.disabled = !hasSelection;
        }

        function updateFoundWordsList() {
            wordListContainer.classList.remove('hidden');
            foundWordsList.innerHTML = '';
            const sortedWords = Array.from(foundWords).sort();
            sortedWords.forEach(word => {
                const li = document.createElement('li');
                li.textContent = word;
                li.className = 'text-sm py-1 px-2 rounded-md bg-gray-700 list-word';
                foundWordsList.appendChild(li);
            });
            foundCountDisplay.textContent = foundWords.size;
        }

        // --- Event Listeners ---
        gridContainer.addEventListener('click', (event) => {
            if (event.target.classList.contains('grid-cell') || event.target.classList.contains('h-20')) {
                selectLetter(event.target);
            }
        });

        submitBtn.addEventListener('click', submitWord);
        clearBtn.addEventListener('click', clearAndReset);
        newGameBtn.addEventListener('click', newGame);
        
        // Keyboard navigation
        document.addEventListener('keydown', (event) => {
            const activeElement = document.activeElement;
            if (activeElement && (activeElement.classList.contains('grid-cell') || activeElement.classList.contains('h-20'))) {
                const key = event.key;
                let newRow = parseInt(activeElement.getAttribute('data-row'));
                let newCol = parseInt(activeElement.getAttribute('data-col'));

                if (key === 'ArrowUp') {
                    newRow = Math.max(0, newRow - 1);
                } else if (key === 'ArrowDown') {
                    newRow = Math.min(2, newRow + 1);
                } else if (key === 'ArrowLeft') {
                    newCol = Math.max(0, newCol - 1);
                } else if (key === 'ArrowRight') {
                    newCol = Math.min(2, newCol + 1);
                } else if (key === 'Enter') {
                    event.preventDefault();
                    submitWord();
                    return;
                } else if (key === ' ') {
                    event.preventDefault();
                    selectLetter(activeElement);
                    return;
                } else if (key === 'Backspace') {
                    event.preventDefault();
                    clearAndReset("Word cleared.");
                    return;
                } else {
                    return;
                }
                const nextCell = gridContainer.querySelector(`[data-row="${newRow}"][data-col="${newCol}"]`);
                if (nextCell) {
                    activeElement.setAttribute('tabindex', '-1');
                    nextCell.setAttribute('tabindex', '0');
                    nextCell.focus();
                }
            } else if (event.key === 'Enter' && (activeElement.id === 'submit-btn' || activeElement.id === 'new-game-btn' || activeElement.id === 'restart-game-btn' || activeElement.id === 'clear-btn' || activeElement.id === 'save-btn' || activeElement.id === 'load-game-btn')) {
                activeElement.click();
            }

        });

        // **Crucial: This command starts the game when the page loads.**
        // It's the only onload listener you should have.
        window.onload = loadAndPrepareGame;
    </script>
</body>
</html>

